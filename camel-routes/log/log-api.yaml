- from:
    uri: direct:product
    steps:
      - onCompletion:
          steps:
            - choice:
                when:
                  - simple: ${exchangeProperty.fail} == true
                    steps:
                      - process:
                          ref: LogProcessor
                      - log: "Error"
                      - to:
                          uri: kafka:errors?groupId=logs-consumer-group
                otherwise:
                  steps:
                    - process:
                        ref: LogProcessor
                    - log: "Success"
                    - to:
                        uri: kafka:logs?groupId=logs-consumer-group
      - onException:
          exception: java.lang.Exception
          handled:
            constant: true
          steps:
            - setProperty:
                name: fail
                simple: "true"
      - process:
          ref: SelectProduct
